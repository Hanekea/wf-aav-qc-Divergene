# This file provides minimal examples of the two AAV structure categories and is used
# for testing purposes.
#
# 1. The aln_types that are initially assigned to each alignment
# 2. The read assignments (assigned_genome_subtypes), which are defined by the 
# constituent aln_types of each read.


itr1_start: 11
itr1_end: 156
itr2_start: 2324
itr2_end: 2454
itr_fl_threshold: 100

# Alignment Types (These examples include all the AlnTypes that can be expected)
# aln_type: the description of the alignment type as defined in the ENUM 
#   structure_definintions.AlnType. 
# Examples: one of more alignment info entries that map to the given AlnType
#  The components of the examples are:
#   - reference (this has no bearing on the results)
#   - start (reference start location)
#   - end (reference end location)
#   - strand
#   - IsSec (not needed for testing, always 0 here, but included)

aln_types:
  - aln_type: 'Almost complete'
    examples:
      - 'flip_flop 15 2449 1 0'
      - 'flip_flop 14 2448 -1 0'
  - aln_type: 'Partial 5` ITR and full 3` ITR'
    examples:
      - 'flip_flop 112 2454 1 0'
      - 'flip_flop 120 2446 -1 0'

  - aln_type: 'Partial 5` ITR and partial 3` ITR'
    examples:
      - 'flip_flop 112 2325 1 0'
      - 'flip_flop 122 2354 -1 0'

  - aln_type: 'Full 5` ITR and partial 3` ITR'
    examples:
      - 'flip_flop 11 2324 1 0'
      - 'flip_flop 20 2354 -1 0'

  - aln_type: 'Partial - no ITRs'
    examples:
      - 'flip_flop 157 2324 1 0'

  - aln_type: 'Full 5` ITR and partial mid section'
    examples:
      - 'flip_flop 11 1500 1 0'
      - 'flip_flop 20 2323 -1 0'

  - aln_type: 'Partial mid section and full 3` ITR'
    examples:
      -  'flip_flop 157 2445 1 0'
      - 'flip_flop 2324 2453 -1 0'

  - aln_type: 'Partial 5` ITR and partial mid section'
    examples:
      - 'flip_flop 150 1500 1 0'
      - 'flip_flop 155 2323 -1 0'

  - aln_type: 'Partial mid section and partial 3` ITR'
    examples:
      - 'flip_flop 1500 2330 1 0'
      - 'flip_flop 300  2340 -1 0'

  - aln_type: '5` ITR'
    examples:
      -  'flip_flop 11 156 1 0'
      - 'flip_flop 50 100 -1 0'

  - aln_type: '3` ITR'
    examples:
      - 'flip_flop 2325 2454 1 0'
      - 'flip_flop 2350 2450 -1 0'

  # Backbone is considered to be < 20 nt of the ITR1 start or > 20 nt of the ITR2 end
  # Therefore negative values indicate start positions before the ITR1 start.
  - aln_type: 'Vector backbone - 5` end'
    examples:
      - 'flip_flop -10  100 1 0'
      - 'flip_flop -10 200 -1 0'

  - aln_type: 'Vector backbone - 3` end'
    examples:
      - 'flip_flop 2454  2600 1 0'
      - 'flip_flop 2000 2475 -1 0'

  # Backbone on both sides of the ITRs
  - aln_type: 'Backbone'
    examples:
      - 'flip_flop -10  10 1 0'
      - 'flip_flop 2455 2600 -1 0'

  # Extends on both sides into backbone
  - aln_type: 'Extended ITR-ITR region'
    examples:
      - 'flip_flop -20  24700 1 0'
      - 'flip_flop -30 2600 -1 0'


# Assigned_genome_subtypes test data.
# Each entry provides examples of reads and the resulting AAV genome_subtype and genome_type parent
#   Note: some genome_types do not have any subtypes (such as Full_ssAAV)
#   and in these cases genome_type and genome_subtype will be the same
# An example contains information from one or more alignments. The alignments entries also include an AlnType assignment.
# The number of alignments present in an example depends on how many alignments are required to fully specify the
# read type.
# For most of these examples, only the identity of the aln types is used to determine the read type. But some of the
# examples are tested for symmetry and so the alignment start and end positions are required to be meaningful in
# these cases (these are present at the bottom).
# Note: Each possible genome_subtype is present here, but not each potential combination of AlnTypes are currently tested


# The elements of each alignment in the examples are
# 1: String of alignment info
#  - read_id
#  - reference
#  - start
#  - end
#  - strand
#  - isSec # we can get rid of this
#  2 : the associated aln_type

# TODO:
# Most of these categories do not take into account the start and end positions but some do need this info
# For those categories that do not use position info, set Pos and EndPOs to -1 to make this clear
genome_types:
  - genome_subtype: 'Full_ssAAV'
    genome_type: 'Full_ssAAV'
    examples:
    - [['full_ssaav_1 flip_flop 15 2449 1 0', 'Almost complete']]

  - genome_subtype: 'GDM'
    # GDM is 2 alignments on the same strand with a gap in between
    genome_type: 'Partial ssAAV'
    examples:
      - [['gdm_1 flip_flop 15 100 1 0', 'Partial - no ITRs'], ['gdm_1 flip_flop 1100 2400 1 0', 'Partial - no ITRs']]
      - [['gdm_2 flip_flop 15 1000 1 0', 'Full 5` ITR and partial mid section'], ['gdm_2 flip_flop 2300 2448 1 0', 'Partial mid section and partial 3` ITR']]

  - genome_subtype: '3` ICG'
    genome_type: 'Partial ssAAV'
    examples:
      - [ [ 'icg3_1 flip_flop 1 100 1 0', 'Partial 5` ITR and full 3` ITR' ] ]
      - [ [ 'icg3_2 flip_flop 1 100 1 0', 'Partial mid section and full 3` ITR' ] ]

  - genome_subtype: '5` ICG'
    genome_type: 'Partial ssAAV'
    examples:
      - [ [ 'icg5_1 flip_flop 1 100 1 0', 'Full 5` ITR and partial 3` ITR' ] ]
      - [ [ 'icg5_2 flip_flop 1 100 1 0', 'Full 5` ITR and partial mid section' ] ]

  - genome_subtype: 'Partial ICG - incomplete ITRs'
    genome_type: 'Partial ssAAV'
    examples:
        - [ [ 'par_icg_1 flip_flop 1 100 1 0', 'Partial 5` ITR and partial mid section' ] ]
        - [ [ 'par_icg_2 flip_flop 1 100 1 0', 'Partial mid section and partial 3` ITR' ] ]

  - genome_subtype: 'Partial ICG - no ITRs'
    genome_type: 'Partial ssAAV'
    examples:
      - [ [ 'par_icg_3 flip_flop 1 100 1 0', 'Partial - no ITRs' ] ]

  - genome_subtype: 'Full_scAAV'
    genome_type: 'Full_scAAV'
    examples:
      - [['full_scaav_1 flip_flop 15 2449 1 0', 'Almost complete'], ['full_scaav_1 flip_flop 2340 24450  -1 0', 'Almost complete']] # Fix locs
      - [['full_scaav_2 flip_flop 15 2449 1 0', 'Almost complete'], ['full_scaav_2 flip_flop 2340 24450  -1 0', 'Partial 5` ITR and full 3` ITR']]


  - genome_subtype: 'SBG (unresolved)'
    genome_type: 'Partial scAAV'
    examples:
          - [ [ 'sbg5_unres_1 flip_flop 15 2449 1 0', 'Partial 5` ITR and partial 3` ITR' ], [ 'sbg5_unres_1 flip_flop 2340 24450 -1 0', 'Partial - no ITRs' ] ]
          - [ [ 'sbg5_unres_2 flip_flop 15 2449 1 0', 'Partial - no ITRs' ], [ 'sbg5_unres_2 flip_flop 2340 24450 -1 0', 'Partial - no ITRs' ] ]
          - [ ['sbg5_unres_3 flip_flop 0 0 1 0', 'Partial - no ITRs' ], ['sbg5_unres_3 flip_flop 0 0 -1 0', 'Partial - no ITRs' ] ]

  - genome_subtype: 'ITR1 concatemer'
    genome_type: 'ITR region only'
    examples:
          - [ [ 'itr1_cat_1 flip_flop 15 2449 1 0', '5` ITR' ], [ 'itr1_cat_1 flip_flop 2340 24450 -1 0', '5` ITR' ] ]

  - genome_subtype: 'ITR2 concatemer'
    genome_type: 'ITR region only'
    examples:
          - [ [ 'itr2_cat_1 flip_flop 15 2449 1 0', '3` ITR' ], [ 'itr2_cat_1 flip_flop 2340 24450 -1 0', '3` ITR' ] ]

  - genome_subtype: 'ITR1-ITR2 concatemer'
    genome_type: 'ITR region only'
    examples:
          - [ [ 'itr1_2_cat_1 flip_flop 15 2449 1 0', '5` ITR' ], [ 'itr1_2_cat_1 flip_flop 2340 24450 -1 0', '3` ITR' ] ]

  - genome_subtype: 'Partial ICG - part of both ITRs'
    genome_type: 'Partial ssAAV'
    examples:
          - [ [ 'par_icg_both_itrs flip_flop 15 2449 1 0', 'Partial 5` ITR and partial 3` ITR' ] ]

  - genome_subtype: 'Backbone contamination'
    genome_type: 'Backbone contamination'
    # This category can have 1 or two alignments
    examples:
          # Single alignment per read
          - [ [ 'bb_1 flip_flop -10 2449 1 0',  'Vector backbone - 5` end'] ]
          - [ [ 'bb_2 flip_flop 15 2475 1 0',  'Vector backbone - 3` end'] ]
          # two alignments per read
          - [ [ 'bb_3 flip_flop -10 2449 1 0',  'Vector backbone - 5` end'], [ 'bb_3 flip_flop 15 24600 -1 0',  'Vector backbone - 3` end'] ]

  - genome_subtype: 'Complex'
    genome_type: 'Complex'
    examples:
      # 3 or more alignments
      - [ [ 'complex1 flip_flop 1000 2400 1 0', 'Partial mid section and full 3` ITR' ], [ 'complex1 flip_flop 900 2412 -1 0', 'Partial mid section and full 3` ITR' ],  [ 'complex1 flip_flop 900 2412 -1 0', 'Partial mid section and full 3` ITR' ]  ]
      # Overlapping primary and supplementary alignments
      - [ [ 'complex2 flip_flop 1000 2400 1 0', 'NA' ], [ 'complex2 flip_flop 2000 2412 1 0', 'NA' ] ]

#  - genome_subtype: 'Unknown'
#  # Not covered by any other category
#    examples:
#      - [[ 'unknown1 flip_flop 1000 2400 1 0', '5` ITR' ],  [ 'unknown1 flip_flop 1000 2400 1 0', 'Partial - no ITRs' ]]

  # The examples below here are tested for symmetrical alignments. Therefore, the start and end positions are meaningful
  # TODO move the rest of the symmetrical tests here
  - genome_subtype: 'SBG 5` symmetric'
    genome_type: 'Partial scAAV'
    # This example uses the positions to determine
    examples: # This is coming out as asymmetric
      - [ [ 'sbg5_sym_1 flip_flop 15 1500 1 0', 'Full 5` ITR and partial mid section' ], [ 'sbg5_sym_1 flip_flop 15 1505 -1 0', 'Full 5` ITR and partial mid section' ] ]

  - genome_subtype: 'SBG 3` asymmetric'
    genome_type: 'Partial scAAV'
    examples:
      - [['sbg_1 flip_flop 15 2449 1 0', 'Almost complete' ], ['sbg_1 flip_flop 2340 24450 -1 0', 'Partial mid section and full 3` ITR']]

  - genome_subtype: 'SBG 3` incomplete ITR asymmetric'
    genome_type: 'Partial scAAV'
    examples:
      - [['sbg3_incom_asym_1 flip_flop 15 2449 1 0', 'Almost complete' ], ['sbg3_incom_asym_1 flip_flop 2340 24450 -1 0', 'Partial mid section and partial 3` ITR']]
      - [['sbg3_incom_asym_2 flip_flop 15 2449 1 0', 'Partial mid section and full 3` ITR' ], ['sbg3_incom_asym_2 flip_flop 30 24450 -1 0', 'Partial mid section and partial 3` ITR']]
      - [[ 'sbg3_incom_asym_3 flip_flop 150 1500 1 0', 'Partial mid section and partial 3` ITR' ], [ 'sbg3_incom_asym_3 flip_flop 135 1499 -1 0', 'Partial mid section and partial 3` ITR' ]]

  - genome_subtype: 'SBG 3` incomplete ITR symmetric'
    genome_type: 'Partial scAAV'
    examples:
      - [['sbg3_incom_sym_1 flip_flop 15 2449 1 0', 'Partial mid section and full 3` ITR' ], ['sbg3_incom_sym_1 flip_flop 17 24450 -1 0', 'Partial mid section and partial 3` ITR']]
      - [['sbg3_incom_sym_2 flip_flop 150 1500 1 0', 'Partial mid section and partial 3` ITR' ], [ 'sbg3_incom_sym_2 flip_flop 149 1499 -1 0', 'Partial mid section and partial 3` ITR' ] ]

  - genome_subtype: 'SBG 5` asymmetric'
    genome_type: 'Partial scAAV'
    examples:
      - [ [ 'sbg5_asym_1 flip_flop 0 0 1 0', 'Full 5` ITR and partial mid section' ], [ 'sbg5_asym_1 flip_flop 0 0 -1 0', 'Full 5` ITR and partial 3` ITR' ] ]
      - [ [ 'sbg5_asym_2 flip_flop 11 1500 1 0', 'Full 5` ITR and partial mid section' ], [ 'sbg5_asym_2 flip_flop 11 1502 -1 0', 'Full 5` ITR and partial 3` ITR' ] ]

  - genome_subtype: 'SBG 5` incomplete ITR asymmetric'
    genome_type: 'Partial scAAV'
    examples:
      - [ [ 'sbg5_incom_itr_asym_1 flip_flop 15 2449 1 0', 'Partial 5` ITR and full 3` ITR' ], [ 'sbg5_incom_itr_asym_1 flip_flop 2340 24450 -1 0', 'Full 5` ITR and partial mid section' ] ]
      - [ [ 'sbg5_incom_itr_asym_2 flip_flop 15 1500 1 0', 'Full 5` ITR and partial mid section' ], [ 'sbg5_incom_itr_asym_2 flip_flop 15 1600 -1 0', 'Partial 5` ITR and partial mid section' ] ]
      - [ [ 'sbg5_incom_itr_asym_3 flip_flop 15 1500 1 0','Partial 5` ITR and partial mid section' ], [ 'sbg5_incom_itr_asym_3 flip_flop 15 1600 -1 0', 'Partial 5` ITR and partial mid section' ] ]

  - genome_subtype: 'SBG 5` incomplete ITR symmetric'
    genome_type: 'Partial scAAV'
    examples:
      - [ [ 'sbg5_incom_sym_1 flip_flop 120 1600 1 0', 'Partial 5` ITR and partial mid section'  ], ['sbg5_incom_sym_1 flip_flop 121 1601 -1 0', 'Partial 5` ITR and partial mid section']]
      - [ [ 'sbg5_incom_sym_2 flip_flop 150 1500 1 0', 'Partial 5` ITR and partial mid section' ], [ 'sbg5_incom_sym_2 flip_flop 20 1499 -1 0', 'Full 5` ITR and partial mid section' ] ]

  - genome_subtype: 'SBG 3` symmetric'
    genome_type: 'Partial scAAV'
    examples:
      - [ [ 'sbg3_sym_1 flip_flop 1000 2400 1 0', 'Partial mid section and full 3` ITR' ], [ 'sbg3_sym_1 flip_flop 1001 2405 -1 0', 'Partial mid section and full 3` ITR' ] ]

  - genome_subtype: 'SBG 3` asymmetric'
    genome_type: 'Partial scAAV'
    examples:
      - [ [ 'sbg3_asym_1 flip_flop 1000 2400 1 0', 'Partial mid section and full 3` ITR' ], [ 'sbg3_asym_1 flip_flop 900 2412 -1 0', 'Partial mid section and full 3` ITR' ] ]
